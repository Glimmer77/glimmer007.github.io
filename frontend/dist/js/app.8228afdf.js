(()=>{"use strict";var e={346:(e,t,s)=>{var o=s(3751),a=s(641);function r(e,t,s,o,r,l){const n=(0,a.g2)("Navbar"),u=(0,a.g2)("router-view"),i=(0,a.g2)("v-main"),d=(0,a.g2)("v-app");return(0,a.uX)(),(0,a.Wv)(d,null,{default:(0,a.k6)((()=>[(0,a.bF)(n),(0,a.bF)(i,null,{default:(0,a.k6)((()=>[(0,a.bF)(u)])),_:1})])),_:1})}function l(e,t,s,o,r,l){const n=(0,a.g2)("v-toolbar-title"),u=(0,a.g2)("v-spacer"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("v-app-bar");return(0,a.uX)(),(0,a.Wv)(d,{app:""},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("在线社区论坛")]))),_:1}),(0,a.bF)(u),(0,a.bF)(i,{to:"/",text:""},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("首页")]))),_:1}),(0,a.bF)(i,{to:"/posts",text:""},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("帖子列表")]))),_:1}),(0,a.bF)(i,{to:"/register",text:""},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("注册")]))),_:1}),(0,a.bF)(i,{to:"/login",text:""},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("登录")]))),_:1}),(0,a.bF)(i,{to:"/create-post",text:""},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("创建帖子")]))),_:1})])),_:1})}const n={name:"Navbar"};var u=s(6262);const i=(0,u.A)(n,[["render",l]]),d=i,c={components:{Navbar:d}},m=(0,u.A)(c,[["render",r]]),p=m;var f=s(5220);function g(e,t,s,o,r,l){const n=(0,a.g2)("v-col"),u=(0,a.g2)("v-row"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("router-link"),c=(0,a.g2)("v-card-actions"),m=(0,a.g2)("v-card"),p=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,{cols:"12"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("h1",null,"欢迎来到在线社区论坛",-1),(0,a.Lk)("p",null,"在这里，你可以分享你的想法和经验，与其他用户交流。",-1)]))),_:1})])),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,{cols:"12",sm:"6",class:"d-flex justify-center"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{to:"/login"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{color:"success",class:"mx-2"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("登录")]))),_:1})])),_:1}),(0,a.bF)(d,{to:"/register"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{color:"info",class:"mx-2"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("注册")]))),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{class:"mx-auto","max-width":"400"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{to:"/posts"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{color:"primary"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("查看帖子")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bF)(n,{cols:"12",md:"6"},{default:(0,a.k6)((()=>[(0,a.bF)(m,{class:"mx-auto","max-width":"400"},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{to:"/create-post"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{color:"primary"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("创建帖子")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}const b={name:"Home",data(){return{isLoggedIn:!1}},mounted(){this.isLoggedIn=!!localStorage.getItem("userToken")}},v=(0,u.A)(b,[["render",g],["__scopeId","data-v-097ed845"]]),h=v;var k=s(33);const _={key:0,class:"error"};function F(e,t,s,r,l,n){const u=(0,a.g2)("v-text-field"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("v-form"),c=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{ref:"registerForm",onSubmit:(0,o.D$)(n.register,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:l.username,"onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),label:"用户名",required:"",rules:[l.usernameRules],outlined:"",dense:""},null,8,["modelValue","rules"]),(0,a.bF)(u,{modelValue:l.password,"onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),label:"密码",type:"password",required:"",rules:[l.passwordRules],outlined:"",dense:""},null,8,["modelValue","rules"]),(0,a.bF)(u,{modelValue:l.email,"onUpdate:modelValue":t[2]||(t[2]=e=>l.email=e),label:"邮箱",required:"",rules:[l.emailRules],outlined:"",dense:""},null,8,["modelValue","rules"]),(0,a.bF)(i,{type:"submit",color:"success",disabled:!n.isValid},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("注册")]))),_:1},8,["disabled"]),l.error?((0,a.uX)(),(0,a.CE)("div",_,(0,k.v_)(l.error),1)):(0,a.Q3)("",!0)])),_:1},8,["onSubmit"])])),_:1})}var y=s(4335),w=s(6278);const W={data(){return{username:"",password:"",email:"",error:null,usernameRules:[e=>!!e||"用户名不能为空"],passwordRules:[e=>!!e||"密码不能为空"],emailRules:[e=>!!e||"邮箱不能为空",e=>/.+@.+\..+/.test(e)||"请输入有效的邮箱地址"]}},computed:{isValid(){return this.username&&this.password&&this.email}},methods:{...(0,w.i0)(["setUser"]),async register(){this.error=null;try{const e=await y.A.post("http://localhost:3000/api/users/register",{username:this.username,password:this.password,email:this.email});e&&e.data?(alert(e.data.message),this.$router.push("/login")):this.error="服务器没有返回有效数据"}catch(e){e.response&&e.response.data&&e.response.data.message?this.error=e.response.data.message:this.error="请求失败，请稍后再试",console.error("注册失败:",e)}}}},A=(0,u.A)(W,[["render",F],["__scopeId","data-v-7523a7fe"]]),V=A,C={key:0,class:"error"};function I(e,t,s,r,l,n){const u=(0,a.g2)("v-text-field"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("v-form"),c=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{ref:"loginForm",onSubmit:(0,o.D$)(n.login,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:l.username,"onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),label:"用户名",required:"",rules:[l.usernameRules],outlined:"",dense:""},null,8,["modelValue","rules"]),(0,a.bF)(u,{modelValue:l.password,"onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),label:"密码",type:"password",required:"",rules:[l.passwordRules],outlined:"",dense:""},null,8,["modelValue","rules"]),(0,a.bF)(i,{type:"submit",color:"success",disabled:!n.isValid},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("登录")]))),_:1},8,["disabled"]),l.error?((0,a.uX)(),(0,a.CE)("div",C,(0,k.v_)(l.error),1)):(0,a.Q3)("",!0)])),_:1},8,["onSubmit"])])),_:1})}const x={data(){return{username:"",password:"",error:null,usernameRules:[e=>!!e||"用户名不能为空"],passwordRules:[e=>!!e||"密码不能为空"]}},computed:{isValid(){return this.username&&this.password}},methods:{...(0,w.i0)(["setUser"]),async login(){this.error=null;try{const e=await y.A.post("http://localhost:3000/api/users/login",{username:this.username,password:this.password});alert(e.data.message),localStorage.setItem("token",e.data.token),this.setUser({token:e.data.token}),this.$router.push("/posts")}catch(e){this.error=e.response.data.message}}}},S=(0,u.A)(x,[["render",I],["__scopeId","data-v-df56ad38"]]),X=S,$={key:0};function E(e,t,s,o,r,l){const n=(0,a.g2)("v-progress-circular"),u=(0,a.g2)("v-alert"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("v-list-item-title"),c=(0,a.g2)("v-list-item-subtitle"),m=(0,a.g2)("v-list-item-content"),p=(0,a.g2)("v-list-item"),f=(0,a.g2)("v-list-item-group"),g=(0,a.g2)("v-list"),b=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(b,null,{default:(0,a.k6)((()=>[r.loading?((0,a.uX)(),(0,a.Wv)(n,{key:0,indeterminate:"",color:"primary",class:"my-5"})):((0,a.uX)(),(0,a.Wv)(g,{key:1},{default:(0,a.k6)((()=>[0===r.posts.length?((0,a.uX)(),(0,a.CE)("div",$,[(0,a.bF)(u,{type:"info",dismissible:""},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)(" 当前没有帖子，快来创建一个吧！ ")]))),_:1}),(0,a.bF)(i,{color:"primary",onClick:l.goToCreatePost},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)(" 创建帖子 ")]))),_:1},8,["onClick"])])):(0,a.Q3)("",!0),r.posts.length>0?((0,a.uX)(),(0,a.Wv)(f,{key:1},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.posts,(e=>((0,a.uX)(),(0,a.Wv)(p,{key:e._id,to:`/posts/${e._id}`},{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"post-title"},{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(e.title),1)])),_:2},1024),(0,a.bF)(c,{class:"post-content"},{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(e.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["to"])))),128))])),_:1})):(0,a.Q3)("",!0)])),_:1}))])),_:1})}const U={data(){return{posts:[],loading:!0}},async created(){try{const e=await y.A.get("http://localhost:3000/api/posts/list");if(!(e&&e.data&&Array.isArray(e.data.posts)))throw new Error("无效的帖子数据");this.posts=e.data.posts}catch(e){console.error("获取帖子列表失败:",e),alert("无法加载帖子列表，请稍后再试。")}finally{this.loading=!1}},methods:{goToCreatePost(){this.$router.push("/create-post")}}},O=(0,u.A)(U,[["render",E],["__scopeId","data-v-3c0daa95"]]),P=O;function R(e,t,s,o,r,l){const n=(0,a.g2)("v-card-title"),u=(0,a.g2)("v-card-subtitle"),i=(0,a.g2)("v-card-text"),d=(0,a.g2)("v-btn"),c=(0,a.g2)("v-card"),m=(0,a.g2)("CommentList"),p=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(p,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(r.post.title),1)])),_:1}),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.eW)("作者: "+(0,k.v_)(r.post.userId.username),1)])),_:1}),(0,a.bF)(i,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(r.post.content),1)])),_:1}),(0,a.bF)(d,{onClick:l.likePost},{default:(0,a.k6)((()=>[(0,a.eW)("点赞 ("+(0,k.v_)(r.post.likes)+")",1)])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(m,{postId:r.post._id},null,8,["postId"])])),_:1})}function q(e,t,s,o,r,l){const n=(0,a.g2)("v-list-item-title"),u=(0,a.g2)("v-list-item-subtitle"),i=(0,a.g2)("v-list-item-content"),d=(0,a.g2)("v-list-item"),c=(0,a.g2)("v-list-item-group"),m=(0,a.g2)("v-list"),p=(0,a.g2)("CreateComment"),f=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(f,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.comments,(e=>((0,a.uX)(),(0,a.Wv)(d,{key:e._id},{default:(0,a.k6)((()=>[(0,a.bF)(i,null,{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(e.userId.username),1)])),_:2},1024),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,k.v_)(e.content),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,a.bF)(p,{postId:s.postId,onCommentAdded:l.fetchComments},null,8,["postId","onCommentAdded"])])),_:1})}function L(e,t,s,r,l,n){const u=(0,a.g2)("v-text-field"),i=(0,a.g2)("v-btn"),d=(0,a.g2)("v-form"),c=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{onSubmit:(0,o.D$)(n.createComment,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:l.content,"onUpdate:modelValue":t[0]||(t[0]=e=>l.content=e),label:"评论内容",required:""},null,8,["modelValue"]),(0,a.bF)(i,{type:"submit",color:"success"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("提交评论")]))),_:1})])),_:1},8,["onSubmit"])])),_:1})}const j={props:["postId"],data(){return{content:""}},methods:{async createComment(){const e=localStorage.getItem("token");try{await y.A.post(`http://localhost:3000/api/comments/create/${this.postId}`,{content:this.content},{headers:{Authorization:`Bearer ${e}`}}),this.$emit("comment-added"),this.content=""}catch(t){alert(t.response.data.message)}}}},T=(0,u.A)(j,[["render",L]]),D=T,N={props:["postId"],data(){return{comments:[]}},components:{CreateComment:D},async created(){await this.fetchComments()},methods:{async fetchComments(){try{const e=await y.A.get(`http://localhost:3000/api/comments/${this.postId}`);this.comments=e.data.comments}catch(e){alert(e.response.data.message)}}}},Q=(0,u.A)(N,[["render",q]]),z=Q,B={data(){return{post:{}}},components:{CommentList:z},async created(){const e=await y.A.get(`http://localhost:3000/api/posts/${this.$route.params.id}`);this.post=e.data.post},methods:{async likePost(){const e=localStorage.getItem("token");await y.A.post(`http://localhost:3000/api/likes/like/${this.post._id}`,{},{headers:{Authorization:`Bearer ${e}`}}),this.post.likes++}}},H=(0,u.A)(B,[["render",R]]),K=H;function M(e,t,s,r,l,n){const u=(0,a.g2)("v-text-field"),i=(0,a.g2)("v-textarea"),d=(0,a.g2)("v-btn"),c=(0,a.g2)("v-form"),m=(0,a.g2)("v-container");return(0,a.uX)(),(0,a.Wv)(m,null,{default:(0,a.k6)((()=>[(0,a.bF)(c,{onSubmit:(0,o.D$)(n.createPost,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:l.title,"onUpdate:modelValue":t[0]||(t[0]=e=>l.title=e),label:"标题",required:""},null,8,["modelValue"]),(0,a.bF)(i,{modelValue:l.content,"onUpdate:modelValue":t[1]||(t[1]=e=>l.content=e),label:"内容",required:""},null,8,["modelValue"]),(0,a.bF)(d,{type:"submit",color:"success"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("创建帖子")]))),_:1})])),_:1},8,["onSubmit"])])),_:1})}const G={data(){return{title:"",content:""}},methods:{async createPost(){const e=localStorage.getItem("token");try{const t=await y.A.post("http://localhost:3000/api/posts/create",{title:this.title,content:this.content},{headers:{Authorization:`Bearer ${e}`}});alert(t.data.message),this.$router.push("/posts")}catch(t){alert(t.response.data.message)}}}},J=(0,u.A)(G,[["render",M]]),Y=J,Z=[{path:"/",name:"Home",component:h},{path:"/register",name:"Register",component:V},{path:"/login",name:"Login",component:X},{path:"/posts",name:"PostList",component:P,meta:{requiresAuth:!0}},{path:"/posts/:id",name:"PostDetail",component:K,meta:{requiresAuth:!0}},{path:"/create-post",name:"CreatePost",component:Y,meta:{requiresAuth:!0}}],ee=(0,f.aE)({history:(0,f.LA)(),routes:Z});ee.beforeEach(((e,t,s)=>{const o=e.matched.some((e=>e.meta.requiresAuth)),a=(0,w.L8)(["isAuthenticated"]);o&&!a?s("/login"):s()}));const te=ee,se=(0,w.y$)({state:{user:null},mutations:{SET_USER(e,t){e.user=t}},actions:{setUser({commit:e},t){e("SET_USER",t)}},getters:{isAuthenticated:e=>!!e.user}});var oe=s(4825),ae=(s(5524),s(2938)),re=s(3379);const le=(0,oe.$N)({components:ae,directives:re,theme:{dark:!0}}),ne=(0,o.Ef)(p);ne.use(te),ne.use(se),ne.use(le),ne.mount("#app")}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,o,a,r)=>{if(!o){var l=1/0;for(d=0;d<e.length;d++){for(var[o,a,r]=e[d],n=!0,u=0;u<o.length;u++)(!1&r||l>=r)&&Object.keys(s.O).every((e=>s.O[e](o[u])))?o.splice(u--,1):(n=!1,r<l&&(l=r));if(n){e.splice(d--,1);var i=a();void 0!==i&&(t=i)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,a,r]}})(),(()=>{s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};s.O.j=t=>0===e[t];var t=(t,o)=>{var a,r,[l,n,u]=o,i=0;if(l.some((t=>0!==e[t]))){for(a in n)s.o(n,a)&&(s.m[a]=n[a]);if(u)var d=u(s)}for(t&&t(o);i<l.length;i++)r=l[i],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},o=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=s.O(void 0,[504],(()=>s(346)));o=s.O(o)})();
//# sourceMappingURL=app.8228afdf.js.map